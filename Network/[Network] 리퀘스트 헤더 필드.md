## 리퀘스트 헤더 필드

리퀘스트 헤더 필드는 클라이언트 측에서 서버 측으로 송신된 리퀘스트 메시지에 사용되는 헤더로, 리퀘스트의 부가 정보와 클라이언트의 정보, 리스폰스의 콘텐츠에 관한 우선 순위 등을 추가합니다.

## 1. Accept

```http
Accept: text/html, application/xhtml+xml, application/xml;q=0.9, */*;q=0.8
```

유저 에이전트에 처리할 수 있는 미디어 타입과 미디어 타입의 상대적인 순위를 전달하기 위해서 사용됩니다. 미디어 타입의 지정은 "타입/서브 타입" 으로서 한 번에 여러 번 설정할 수도 있습니다.

- 텍스트 파일

> text/html, text/plain, text/css...
>
> Application/xhtml+xml, application/xml...

- 이미지 파일

> image/jpeg, image/gif, image/png...

- 동영상 파일

> Video/mpeg, video/quicktime...

- 애플리케이션용 바이너리 파일

> Application/octet-stream, application/zip...

예를 들면, 브라우저가 PNG 이미지를 표시하지 못하는 경우에는 Accept에 image/png를 지정하지 않고, 처리 가능한 image/gifdhk image/jpeg 등을 지정하도록 합니다.

표시하는 미디어 타입에 우선 순위를 붙이고 싶을 경우에는 세미콜론 ";"으로 구분하고 "q="로 표시할 품질 지수를 더합니다. 품질 계수는 0~1의 범위의 수치를(소수점 3자리까지)로 1이 높은 쪽입니다. default값은 1.0입니다.

## 2. Accept-Charset

```http
Accept-Charset:iso=8859-5, unicode-1-1:q+0.8
```

유저 에이전트에서 처리할 수 있는 문자셋으로, 문자셋의 상대적인 우선 순위를 전달하기 위해서 사용됩니다. 또한 문자셋은 한번에 여러 개를 지정할 수 있습니다. 

Accept 헤더 필드와 마찬가지로, 품질 지수에 의해 상대적 우선 순위를 표시합니다. 이 헤더 필드는 서버 구동형 네고시에이션에 이용됩니다.

## 3. Accept-Encoding

```http
Accept-Encoding: gzip, deflate
```

유저 에이전트가 처리할 수 있는 콘텐츠 코딩과 콘텐츠 코딩의 상대적인 우선 순위를 전달하기 위해서 사용됩니다. 콘텐츠 코딩의 지정은 한 번에 여러 개를 지정할 수 있습니다.

- gzip

파일 압축 프로그램 gzip(GNU zip)에서 생성된 인코딩 포맷(RFC1952)으로 Lempel-Ziv 부호(L777)와 32비트 CRC를 사용합니다.

- compress

UNIX 파일 압축 프로그램 "compress"에 의해서 만들어진 인코딩 포맷으로 Lempel-Ziv-Welch 부호(LZW)를 사용합니다.

- deflate

Zlib 포맷(RFC1950)과 deflate 압축 알고리즘(RFC1951)에 의해서 만들어진 인코딩 포맷을 조합한 것입니다.

- identity

압축과 변형을 하지 않는 디폴트 인코딩 포맷입니다.

Accept 헤더 필드와 같이 품질지수에 의해서 상대적인 우선 순위를 표시합니다. 또한 "*"(애스터리스크)를 지정하면 와일드 카드로서 모든 인코딩 포맷을 가리킵니다.

## 4. Accept-Language

```http
Accpet-Language: ko-kr, en-us;q=0.7, en;q=0.3
```

유저 에이전트가 처리할 수 있는 자연어의 세트(한국어와 영어)와 자연어 세트의 상대적인 우선 순위를 전달하기 위해서 사용됩니다. 자연어 세트는 한 버넹 여러 개를 지정할 수 있습니다.

Accept 헤더 필드와 같이 품질 지수에 의해 상대적인 우선 순위를 나타냅니다.

## 5. Authorization

```http
Authorization: /token/
```

Authorization 헤더 필드는 유저 에이전트의 인증 정보(크리덴셜 값)을 전달하기 위해서 사용됩니다. 통상, 서버에 인증을 받으려 하는 유저 에이전트는 상태 코드 401 리스폰스의 뒤에 리퀘스트에 Authorization 헤더 필드를 포함합니다. 공유 캐시가 Authorization 헤더 필드를 포함하는 리퀘스트를 받은 경우에는 조금은 다른 동작을 합니다.

## 6. Expect

```http
Expect: 100-continue
```

클라이언트가 서버에 특정 동작 요구를 전달합니다. 기대하고 있는 요구에 서버가 응답하지 못해서 에러가 발생하는 경우에는 상태 코드 417 Expectation Failed를 반환합니다. 클라리언트는 이 헤더 필드에 원하는 확장을 딸려 보낼 수 있지만 HTTP/1.1 사양에서는 "100-continue" 만 정의되어 있습니다.

상태 코드 100리스폰스를 가진 클라이언트는 리퀘스트 할 때에 Expect: 100-continue로 지정해야 합니다.

## 7. From

유저 에이전트를 사용하고 있는 유저의 메일 주소를 전달합니다. 기본적으로 검색 엔진 등의 에이전트 책임자에게 연락처 메일 주소를 나타내는 목적으로 사용됩니다. 에이전트를 사용하는 경우에는 되도록 From  헤더 필드를 포함해야 합니다.(에이전트에 따라서는 User-Agent 헤더 필드에 메일 주소를 포함하고 있는 것도 있습니다.)

## 8. Host

```http
Host: www.~.~
```

리퀘스트한 리소스의 인터넷 호스트와 포트번호를 전달합니다. HTTP/1.1에서 유일한 필수 헤더 필드 입니다. 1대의 서버에서 복수의 도메인을 할당할 수 있는 가상 호스트 구조와 관련이 깊은 헤더 필드입니다.

리퀘스트가 서버에 오면 호스트 명을 IP주소로 해결해 리퀘스트가 처리됩니다. 이 때 같은 IP 주소로 복수의 도메인이 적용되어 있다고 한 다면 어느 도메인에 대한 리퀘스트인지 알 수가 없습니다.  그래서 Host 헤더 필드에 리퀘스트를 받을 호스트명을 명확하게 해둘 필요가 있습니다. 서버에 호스트 명이 설정되어 있지 않은 경우에는 값을 비워서 보냅니다.

## 9. If-Match

"If-xxx"라는 서식의 리퀘스트 헤더 필드는 조건부 리퀘스트라고 부릅니다. 조건부 리퀘스트를 받은 서버는 지정된 조건에 맞는 경우에만 리퀘스트를 받습니다.

```http
If-Matched: "123456"
```

If-Matched 헤더 필드는 조건부 리퀘스트의 하나로 서버 상의 리소스를 특정하기 위해서 엔티티 태그(Etag) 값을 전달합니다. 이 때 서버는 약한 ETag 값을 사용할 수 없습니다.

서버는 If-Matched의 필드 값과 리소스의 ETag 값이 일치한 경우에만 리퀘스트를 받아들일 수 있습니다. 일치하지 않으면 상태코드 412 Precondition Failed 리스폰스를 반환합니다.

If-Matched 필드 값에 "*"를 지정할 수도 있습니다. 이 경우에는 ETag 값에 구애받지 않고 리소스가 존재하면 리퀘스트를 처리할 수 있습니다.

## 10. If-Modified-Since

```http
If-Modified-Since: Thu, 15 Apr 2004 00:00:00 GMT
```

조건부 리퀘스트의 하나로 리소스 갱신 날짜가 리퀘스트 요청된 날짜보다 이후라면 리퀘스트를 받아들이겠다는 뜻을 전달합니다. 필드 값에 지정된 날짜 이후에, 지정한 리소스가 갱신되어 있지 않은 경우에는 상태코드 304 Not Modified 리스폰스를 반환합니다.

## 11. If-None-Match

조건부 리퀘스트의 하나로 If-Match 헤더 필드와 반대로 동작합니다. 

GET과 HEAD 메소드에서 If-None-Match 헤더 필드를 사용함으로써 최신의 리소스를 요구하는 것이 되기 때문에 If-Modified-Since 헤더 필드를 사용하는 것과 비슷합니다.

## 12. If-Range

If-Range로 지정한 필드 값(ETag 값, 혹은 날짜를 지정)과 리소스의 ETag 값 혹은 날짜가 일치하면 Range 리퀘스트로서 처리하고 싶다는 것을 전달합니다. 일치하지 않는 경우에는 리소스 전체를 반환합니다.

If-Range 헤더 필드를 사용하지 않는 리퀘스트를 생각해 봅시다. 서버 측의 리소스가 갱신되어 있는 경우, 클라이언트 측에서 가지고 있는 리소스의 일부분은 무효한 것이 되기 때문에 Range 리퀘스트는 당연히 무효합니다. 이 경우에 서버는 일단 상태 코드 412 Precondition Failed 리스폰스를 반환하고 클라이언트에 다시 리퀘스트를 보내도록 재촉합니다. If-Range 헤더 필드를 사용하는 경우와 비교하면 2배의 수고가 필요하게 됩니다.

## 13. If-Unmodified-Since

```http
If-Unmodified-Since: Thu, 15 Apr 2004 00:00:00 GMT
```

If-Modified-Since 헤더 필드와 반대로 동작을 합니다. 지정된 날짜 이후에 갱신된 경우에는 상태코드 412 Precondition Faild 리스폰스를 반환합니다.

## 14. Max-Forwards

```http
Max-Forwards: 10
```

TRACE 혹은 OPTION 메소드에 의한 리퀘스트를 할 때에 전송해도 좋은 서버 수의 최대치를 10진수 정수로 지정합니다. 서버는 다음 서버에 리퀘스트를 전송할 때는 Max-Forwards 값에서 1을 빼서 다시 세트합니다. Max-Forwards 값이 0인 리퀘스트를 받은 경우에는 전송하지 않고 리스폰스를 반환할 필요가 있습니다. 

HTTP를 사용한 통신에서는 리퀘스트가 프록시 서버 등 여러 대의 서버를 경유해 가는 경우가 있습니다. 도중에 프록시 서버에서 무언가의 원인으로 리퀘스트 전송이 실패하게 되면 클라리언트에는 리스폰스가 되돌아 오지 않기 때문에 알 수가 없습니다.

이러한 문제가 발생한 경우의 원인 조사에 Max-Forwards 헤더 필드가 활용됩니다. 필드 값이 0이 되었던 서버가 리스폰스를 하기 때문에 그 서버까지의 상황을 알 수 있습니다.

## 15. Proxy-Authorization

```http
Proxy-Authorization: /token/
```

프록시 서버에서의 인증 요구를 받아들인 때에 인증에 필요한 클라이언트의 정보를 전달합니다.

## 16. Range

```http
Range: bytes=5001-10000
```

리소스의 일부분만 취득하는 Range 리퀘스트를 할 떄 지정 범위를 전달합니다. Range 헤더 필드가 달린 리퀘스트를 받아들인 서버가 리퀘스트를 처리할 수 있는 경우에는 상태코드 206 Partial Content 리스폰스를 반환합니다. Range 리퀘스트를 처리할 수 없는 경우에는 200 OK 리스폰스로 리소스 전체를 반환합니다.

## 17. Referer

```http
Referer: http://~.~.~
```

리퀘스트가 발생한 본래 리소스의 URI를 전달합니다. 기본적으로 Referer 헤더 필드는 보내져야 하지만, 브라우저의 주소창에 직접 URI를 입력한 경우와 보안상 바람직하지 않다고 판단된 경우에는 보내지 않아도 괜찮습니다. 본래 리소스의 URI의 쿼리에 ID 및 패스워드와 비밀 정보 등이 포함되어 있는 경우, Referer를 통해서 그 정보가 다른 서버에 누설되어 버릴 가능성이 있습니다.

## 18. TE

```http
TE:gzip, deflate;q=0.5
```

TE 헤더 필드는 리스폰스로 받을 수 있는 전송 코딩 형식과 상대적인 우선 순위를 전달합니다. Accept-Encoding 헤더 필드와 매우 비슷하지만 여기선 전송 코딩에 적용됩니다.

TE헤더 필드는 전송 코딩의 지정 이외에 Trailer를 동반하는 청크 전송 인코딩 형식을 지정하는 것이 가능합니다. 이 경우 필드 값에 'trailers'라고 기록합니다.

## 19. User-Agent

```http
User-Agent: Mozilla/5.0(Windows NT 6.1) AppleWebKit/535.19(KHTML, like Gecko) Chrome/18.0.1025.162 Safari/525.195
```

리퀘스트를 생성한 브라우저와 유저 에이전트의 이름 등을 전달하기 위한 필드입니다.



