# 쿠키를 위한 헤더 필드

쿠키는 유저 식별과 상태 관리에 사용되고 있는 기능입니다. 웹사이트가 유저의 상태를 관리하기 위해서 웹 브라우저 경유로 유저의 컴퓨터 상에 일시적으로 데이터를 기록해 두고, 다음에 그 유저가 웹 사이트에 엑세스 해 왔을 때 지난번에 발행한 쿠키를 송신받을 수 있습니다.

쿠키가 호출되었을 때는 쿠키의 유효 기한과 송신지의 도메인, 경로, 프로토콜 등을 체크하는 것이 가능하기 때문에, 적절하게 발행된 쿠키는 다른 웹 사이트와 공격자의 공격에 의해 데이터가 도난당하는 일은 없습니다.

## 1. Set-Cookie

```http
Set-Cookie: status-enable; expires=(Dates) => path=/;domain=.hack.jp
```

서버가 클라이언트에 대해서 상태 관리를 시작할 때 다양한 정보를 전달합니다.

#### Set-Cookie 필드 속성

| 속성             | 설명                                                         |
| ---------------- | ------------------------------------------------------------ |
| NAME=VALUE       | 쿠키에 부여된 이름과 값(필수)                                |
| Expires=DATE     | 쿠키 유효 기한(지정되지 않은 경우는 브라우저를 닫을 때 까지) |
| path=PATH        | 쿠키 적용 대상이 되는 서버 상의 디렉토리(지정하지 않은 경우는 도큐먼트와 같은 디렉토리) |
| Domain=도메인 명 | 쿠키 적용 대상이 되는 도메인 명(지정하지 않은 경우는 쿠키를 생성한 서버의 도메인) |
| Secure           | HTTPS로 통신하고 있는 경우에만 쿠키를 송신                   |
| HttpOnlt         | 쿠키를 JavaScript에서 엑세스하지 못하도록 제한               |

### 1) Expire 속성

한 번 서버에 송출한 클라이언트의 쿠키는 서버에서 명시적으로 삭제하는 방법은 없습니다. 유효 기한이 지났다면 쿠키를 덮어 쓰는 것으로 실질적인 클라이언트 측의 쿠키를 삭제하는 것이 가능합니다.

### 2) Path 속성

쿠키의 path 속성은 쿠키를 송출하는 범위를 특정 디렉토리에 한정할 수 있습니다. 그러나 이 지정을 피하는 방법이 있어서 보안 효과는 기대할 수 없습니다.

### 3) Domain 속성

쿠키의 Domain 속성에 의해서 지정된 도메인 명은 후방 일치가 됩니다. 예를 들어, "example.com"로 지정했을 때 "example.com" 이외에 "www.example.com"과 "www2.example.com" 등에서도 쿠키가 송출됩니다.

그렇기 때문에 명시적으로 여러 도메인에 대해서 쿠키를 송출하는 경우를 제외하고 domain 속성은 지정하지 않는 쪽이 안전합니다.

### 4) Secure 속성

쿠키의 secure 속성은 웹페이지가  HTTPS에서 열렸을 때에만 쿠키 송출을 하기 위해서 지정합니다.

### 5) HttpOnly 속성

자바스크립트를 경유해서 쿠키를 취득하지 못하도록 하는 쿠키의 확장 기능입니다. 크로스 사이트 스크립팅(XSS)으로부터 쿠키의 도청을 막는 것을 목적으로 하고 있습니다.

## 2. Cookie

```http
Cookie: status=enable
```

클라이언트가 HTTP의 상태 관리 지원을 원할 때 서버로부터 수신한 쿠키를 이후의 리퀘스트에 포함해서 전달합니다. 쿠키를 여러 개 수신하고 있을 때에는 쿠키를 여러 개 보내는 것도 가능합니다.

## 3. X-Frame-Option

```http
X-Frame-Option: DENY
```

다른 웹 사이트의 프레임에서 표시를 제어하는 HTTP 리스폰스 헤더로, 클릭 재킹이라는 공격을 막는 것을 목적으로 하고 있습니다.

- DENY: 거부
- SAMEORIGIN: Top-level-browsing-context가 일치한 경우에만 허가

## 4. X-XSS-Protection

```http

```

크로스 사이트 스크립팅 대책으로서 브라우저의 XSS 보호 기능을 제어하는 HTTP 리스폰스 헤더 입니다.

- 0: XSS 필터 무효
- 1: XSS 필터 유효

## 5. DNT

Do Not Track이라는 뜻이며 개인 정보 수집을 거부하는 의사를 나타내는 HTTP 리퀘스트 헤더입니다. 타깃 광고 등에 이용되는 트래킹의 거부 의사를 나타내기 위한 방법 중 하나입니다.

- 0: 트래킹 동의
- 1: 트래킹 거부

DNT 헤더 필드의 기능이 유효성을 유지하기 위해서는 웹 서버에서 DNT를 지원해야 합니다.

## 6. P3P

웹 사이트 상의 프라이버시 정책에 P3P(The Platform for Privact Preferences)를 사용하는 것으로, 프로그램이 읽을 수 있는 형태로 나타내기 위한 HTTP 리스폰스 헤더 입니다.

P3P 설정을 할 때 다음과 같은 순서로 실행합니다.

- P3P 정책 작성
- P3P 정책 참조 파일을 작성해서 "/w3c/p3p.xml"에 배치
- P3P 정책으로부터 콤팩트 정책을 작성하고 HTTP 리스폰스 헤더에 출력